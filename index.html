<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MacroDroid Webhook Control Panel</title>
<style>
  body { font-family: Arial,sans-serif; padding:1rem; background:#f0f0f0; }
  #panel { background:#fff; padding:1rem; border-radius:8px; max-width:500px; margin:auto; box-shadow:0 0 10px #ccc; }
  h2 { text-align:center; }
  input,button { width:100%; padding:0.5rem; margin:0.3rem 0; }
  button { background:#007bff; color:#fff; border:none; border-radius:4px; cursor:pointer; }
  button:hover { background:#0056b3; }
  #logBox { background:#222; color:#0f0; padding:0.5rem; height:200px; overflow-y:auto; font-family:monospace; border-radius:4px; }
  #commands { display:none; max-height:400px; overflow-y:auto; }
</style>
</head>
<body>
  <div id="panel">
    <h2>MacroDroid Webhook Control</h2>
    <input id="webhookUrl" placeholder="Paste webhook URL" />
    <button id="proceedBtn">Proceed</button>
    <div id="commands"></div>
    <h3>Logs</h3>
    <div id="logBox"></div>
  </div>

<script>
  const webhookUrlInput = document.getElementById('webhookUrl');
  const proceedBtn = document.getElementById('proceedBtn');
  const commandsDiv = document.getElementById('commands');
  const logBox = document.getElementById('logBox');

  // Example list of 29 MacroDroid actions
  const actionNames = [
    "Enable WiFi","Enable Bluetooth","Toggle Silent Mode","Start Music",
    "Stop Music","Take Screenshot","Open Browser","Flashlight On","Flashlight Off",
    "Send Notification","Show Toast","Vibrate","Set Volume","Play Sound","Launch App",
    "Enable Mobile Data","Disable Mobile Data","Speak Text","Take Photo","Record Video",
    "Lock Device","Unlock Device","Battery Saver On","Battery Saver Off","Reboot Device",
    "Location On","Location Off","Airplane Mode On","Airplane Mode Off"
  ];

  proceedBtn.onclick = () => {
    if (!webhookUrlInput.value.trim()) return alert('Please enter webhook URL first!');
    webhookUrlInput.disabled = true;
    proceedBtn.disabled = true;
    commandsDiv.innerHTML = '';
    commandsDiv.style.display = 'block';
    actionNames.forEach((name, idx) => {
      const btn = document.createElement('button');
      btn.innerText = name;
      btn.onclick = () => triggerCommand(name, idx+1);
      commandsDiv.appendChild(btn);
    });
  };

  function triggerCommand(name, index) {
    const baseUrl = webhookUrlInput.value.trim();
    const fullUrl = `${baseUrl}?action=${encodeURIComponent(name)}`;
    fetch(fullUrl)
      .then(res => {
        log(`✅ ${name} triggered successfully`);
      })
      .catch(err => {
        log(`❌ ${name} failed`);
      });
  }

  function log(msg) {
    const timestamp = new Date().toLocaleTimeString();
    logBox.innerText += `[${timestamp}] ${msg}\n`;
    logBox.scrollTop = logBox.scrollHeight;
  }
</script>
</body>
</html>
